let t;function e(){return Math.floor(4*Math.random())}function r(t){let r,s;if(!t.flat().includes(0))return t;do r=e(),s=e();while(0!==t[r][s])return t[r][s]=[2,2,2,2,2,4,2,2,2,2][Math.floor(10*Math.random())],t}function s(t){let e=document.querySelector(".button");"playing"===t&&(e.innerHTML="Restart",e.classList.add("restart"),e.classList.remove("start"),e.removeEventListener("click",n),e.addEventListener("click",a)),"idle"===t&&(e.innerHTML="Start",e.classList.add("start"),e.classList.remove("restart"),e.removeEventListener("click",a),e.addEventListener("click",n))}function o(e){t=t=>{let r=e[t.key];r&&r()},document.addEventListener("keyup",t)}const i=new class{constructor(t){this.board=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle"}moveLeft(){for(let t=0;t<this.board.length;t++){let e=[];for(let r=0;r<this.board[t].length;r++)0!==this.board[t][r]&&e.push(this.board[t][r]);for(let t=e.length-1;t>0;t--)e[t]===e[t-1]&&(e[t]*=2,e[t-1]=0);let r=e.filter(t=>0!==t);for(;r.length<this.board[t].length;)r.push(0);this.board[t]=r}this.board=r(this.board),this.updateBoard()}moveRight(){for(let t=0;t<this.board.length;t++){let e=[];for(let r=0;r<this.board[t].length;r++)0!==this.board[t][r]&&e.push(this.board[t][r]);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t+1]*=2,e[t]=0,t++);let r=e.filter(t=>0!==t);for(;r.length<this.board[t].length;)r.unshift(0);this.board[t]=r}this.board=r(this.board),this.updateBoard()}moveUp(){for(let t=0;t<this.board[0].length;t++){let e=[];for(let r=0;r<this.board.length;r++)0!==this.board[r][t]&&e.push(this.board[r][t]);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,t++);let r=e.filter(t=>0!==t);for(;r.length<this.board.length;)r.push(0);for(let e=0;e<r.length;e++)this.board[e][t]=r[e]}this.board=r(this.board),this.updateBoard()}moveDown(){for(let t=0;t<this.board[0].length;t++){let e=[];for(let r=0;r<this.board.length;r++)0!==this.board[r][t]&&e.push(this.board[r][t]);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,t++);let r=e.filter(t=>0!==t);for(;r.length<this.board.length;)r.unshift(0);for(let e=0;e<r.length;e++)this.board[e][t]=r[e]}this.board=r(this.board),this.updateBoard()}getScore(){var t;this.score=this.board.reduce((t,e)=>t+e.reduce((t,e)=>t+e,0),0),t=this.score,document.querySelector(".game-score").innerHTML=t}getState(){"playing"!==this.status&&t&&(document.removeEventListener("keyup",t),t=null),"playing"===this.start&&o(h)}start(){this.status="playing",this.board=r(this.board),o(h),s(this.status),this.updateBoard()}restart(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle",s(this.status),this.updateBoard()}updateBoard(){var t;let e=function(t){let e=[];for(let r=0;r<t.length;r+=4)e.push(t.slice(r,r+4));return e}([...document.querySelectorAll(".field-cell")]);for(let t=0;t<this.board.length;t++)for(let r=0;r<this.board[t].length;r++)0!==this.board[t][r]?e[t][r].innerText=this.board[t][r]:e[t][r].innerText="",e[t][r].style.backgroundColor=function(t){if(0===t)return"rgb(200, 200, 200)";let e=[255,0,0],r=Math.min((Math.log2(t)-1)/10,1),s=[255,255,0].map((t,s)=>Math.round(t+(e[s]-t)*r));return`rgb(${s[0]}, ${s[1]}, ${s[2]})`}(this.board[t][r]);this.getScore(),this.status=function(t,e){let r=t.flat();return r.includes(2048)?"win":16===r.filter(t=>0!==t).length&&!function(t){for(let e=0;e<t.length;e++)for(let r=0;r<t[e].length;r++)if(e>0&&t[e][r]===t[e-1][r]||e<t.length-1&&t[e][r]===t[e+1][r]||r>0&&t[e][r]===t[e][r-1]||r<t[e].length-1&&t[e][r]===t[e][r+1])return!0;return!1}(t)?"lose":e}(this.board,this.status),t=this.status,[...document.querySelectorAll(".message")].forEach(e=>{e.classList.contains(`message-${t}`)?e.classList.remove("hidden"):e.classList.add("hidden"),"idle"===t&&document.querySelector(".message-start").classList.remove("hidden")}),this.getState()}};function n(){!function(t){t.start()}(i)}function a(){!function(t){t.restart()}(i)}const h={ArrowRight:function(){i.moveRight()},ArrowLeft:function(){i.moveLeft()},ArrowUp:function(){i.moveUp()},ArrowDown:function(){i.moveDown()}};document.querySelector(".start").addEventListener("click",n);
//# sourceMappingURL=index.de4f1f1a.js.map
